{% load make_link %}
{%load bootstrap4%}
<div class="card col-6 my-5">
    <img src="{{post.image.url}}" class="card-img-top" alt="...">
    <div class="card-body">
        <h5 class="card-title"></h5>
        <div class="d-flex justify-content-between">
            <p class="card-text">{{post|hashtag_link|safe}}</p>
            {%if request.user in post.like_users.all%}
            <a href="{%url 'posts:like_post' post.id%}" class="btn btn-primary bg-light btn-outline-light"><i
                    class="fas fa-heart text-danger "></i><span class="text-dark">
                    {{post.like_users.all|length}}</span></a>
            {%else%}
            <a href="{%url 'posts:like_post' post.id%}" class="btn btn-primary text-dark btn-light"><i
                    class="far fa-heart"></i><span class="text-dark"> {{post.like_users.all|length}}</span></a>
            {%endif%}
        </div>
        <hr>
        <!-- hashtage_link(post) -->
        <!-- 링크가 안전하다고 알려주는 것(안하면 text가 그대로 나옴) -->
        <form action="{%url  'posts:comment_create' post.id%}" method="post">
            {%csrf_token%}
            {%bootstrap_form form%}
            <input type="submit" class="btn btn-primary btn-sm" value="게시">
        </form>


        <hr>

        {%for comment in post.comment_set.all%}
        <div class="align-items-center d-flex justify-content-between">
            <h6>{{comment.user.username}} : {{comment|hashtag_link|safe}}</h6>
            {%if request.user in comment.like_users.all%}
            <a href="{%url 'posts:like_comments' post.id comment.id%}"
                class="btn btn-primary bg-light btn-outline-light mb-2"><i class="fas fa-heart text-danger "></i><span
                    class="text-dark">
                    {{comment.like_users.all|length}}</span></a>
            {%else%}
            <a href="{%url 'posts:like_comments' post.id comment.id%}"
                class="btn btn-primary text-dark btn-light mb-2"><i class="far fa-heart"></i><span class="text-dark">
                    {{comment.like_users.all|length}}</span></a>
            {%endif%}
        </div>


        {%endfor%}
    </div>
</div>